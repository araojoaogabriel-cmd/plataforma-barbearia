<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Felipe Lanes | Barbearia Premium</title>

  <style>
    :root {
      --bg-dark: #0b0b0b;
      --bg-card: #141414;
      --gold: #d4af37;
      --text-light: #f5f5f5;
      --border: #2a2a2a;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      background: var(--bg-dark);
      color: var(--text-light);
    }

    header {
      height: 80vh;
      background: linear-gradient(rgba(0,0,0,.7), rgba(0,0,0,.7)),
        url('https://images.unsplash.com/photo-1599351431202-1e0f0137899a') center/cover;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    header h1 { font-size: 3rem; color: var(--gold); }
    header p { color: #ccc; margin: 20px 0; }

    .btn {
      background: var(--gold);
      color: #000;
      padding: 14px 25px;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
    }

    section {
      padding: 80px 20px;
      max-width: 1100px;
      margin: auto;
    }

    h2 { text-align: center; color: var(--gold); margin-bottom: 40px; }

    .services {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 30px;
      text-align: center;
    }

    .price { color: var(--gold); }

    .booking {
      background: #101010;
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      margin: auto;
    }

    label { display: block; margin-top: 15px; }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: white;
    }

    .payment {
      margin-top: 20px;
      background: var(--bg-card);
      padding: 20px;
      border-radius: 15px;
      border: 1px solid var(--border);
      text-align: center;
    }

    footer {
      border-top: 1px solid var(--border);
      text-align: center;
      padding: 20px;
      color: #888;
    }
  </style>
</head>

<body>

<header>
  <div>
    <h1>Felipe Lanes</h1>
    <p>Barbearia — estilo clássico e atendimento exclusivo</p>
    <button class="btn" onclick="document.getElementById('agenda').scrollIntoView()">Agendar Horário</button>
  </div>
</header>

<section>
  <h2>Serviços</h2>
  <div class="services">
    <div class="card"><h3>Corte Clássico</h3><p class="price">R$ 40</p></div>
    <div class="card"><h3>Barba Premium</h3><p class="price">R$ 35</p></div>
    <div class="card"><h3>Corte + Barba</h3><p class="price">R$ 70</p></div>
  </div>
</section>

<section id="agenda">
  <h2>Agendamento</h2>
  <div class="booking">

    <label>Serviço</label>
    <select id="service">
      <option value="40">Corte Clássico — R$ 40</option>
      <option value="35">Barba Premium — R$ 35</option>
      <option value="70">Corte + Barba — R$ 70</option>
    </select>

    <label>Data</label>
    <input type="date" id="date">

    <label>Horário</label>
    <select id="time"></select>

    <div class="payment">
      <p>Valor: <strong id="valor">R$ 40</strong></p>
      <canvas id="qrcode"></canvas>

      <button class="btn" onclick="agendarHorario()">Agendar Horário</button>
      <button class="btn" onclick="confirmarPagamento()">Confirmar Pagamento</button>
    </div>

  </div>
</section>

<footer>
  © 2026 Barbearia Premium
</footer>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAHbw_bgI8o9orT1wZf2UJ-8xa6F3bZdGE",
    authDomain: "plataforma-barbearia.firebaseapp.com",
    projectId: "plataforma-barbearia",
    storageBucket: "plataforma-barbearia.appspot.com",
    messagingSenderId: "847507003344",
    appId: "1:847507003344:web:cfd0f40f415c4b5dfa0bd5"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const horariosBase = ['09:00','10:00','11:00','14:00','15:00','16:00'];
  const dateInput = document.getElementById('date');
  const timeSelect = document.getElementById('time');
  const serviceSelect = document.getElementById('service');
  const valorSpan = document.getElementById('valor');

  let agendamentoId = null;

  serviceSelect.addEventListener('change', () => {
    valorSpan.textContent = `R$ ${serviceSelect.value}`;
    gerarPix();
  });

  async function atualizarHorarios() {
    timeSelect.innerHTML = '';
    if (!dateInput.value) return;

    const snapshot = await db.collection('agendamentos')
      .where('data', '==', dateInput.value).get();

    const ocupados = snapshot.docs.map(d => d.data().hora);

    horariosBase.forEach(h => {
      if (!ocupados.includes(h)) {
        const opt = document.createElement('option');
        opt.value = h;              // ✅ ALTERAÇÃO ESSENCIAL
        opt.textContent = h;
        timeSelect.appendChild(opt);
      }
    });

    gerarPix();
  }

  dateInput.addEventListener('change', atualizarHorarios);
  timeSelect.addEventListener('change', gerarPix);

  function gerarPix() {
    if (!dateInput.value || !timeSelect.value) return;
    QRCode.toCanvas(
      document.getElementById('qrcode'),
      `PIX FELIPE LANES | ${dateInput.value} ${timeSelect.value} | R$ ${serviceSelect.value}`,
      { width: 180 }
    );
  }

  async function agendarHorario() {
    if (!dateInput.value || !timeSelect.value) {
      alert('Selecione data e horário');
      return;
    }

    const doc = await db.collection('agendamentos').add({
      data: dateInput.value,
      hora: timeSelect.value,
      servico: serviceSelect.options[serviceSelect.selectedIndex].text,
      valor: serviceSelect.value,
      pago: false,
      criadoEm: new Date()
    });

    agendamentoId = doc.id;
    alert('Horário reservado! Agora confirme o pagamento.');
    atualizarHorarios();
  }

  async function confirmarPagamento() {
    if (!agendamentoId) {
      alert('Agende o horário primeiro');
      return;
    }

    await db.collection('agendamentos').doc(agendamentoId).update({
      pago: true
    });

    alert('Pagamento confirmado! Agendamento concluído.');
  }
</script>

</body>
</html>


